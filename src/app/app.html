<div class="app-container">
  <h1 class="main-title">ðŸ“¸ My Photo Gallery</h1>

  <div class="search-container">
    <input
      #searchinput
      type="text"
      placeholder="Search photos by author name..."
      [value]="photoService.searchQuery()"
      (input)="onSearch($event)"
      (focus)="onFocus()"
      (blur)="onBlur()"
      class="search-input"
    />
    @if (photoService.searchQuery()) {
    <button class="clear-search-button" (click)="clearSearch()" title="Clear search">âœ•</button>
    }

    <!-- Search results info -->
    @if (photoService.searchQuery()) {
    <div class="search-info">
      <span class="search-results">
        Found {{ photoService.totalPhotos() }} photo{{
          photoService.totalPhotos() === 1 ? '' : 's'
        }}
        for "{{ photoService.searchQuery() }}"
      </span>
    </div>
    }
  </div>

  <!-- PHOTO COUNT INFO -->
  @if (photoService.totalPhotos() > 0) {
  <div class="gallery-info">
    @if (photoService.searchQuery()) {
    <p>
      Showing {{ photoService.totalPhotos() }} of {{ photoService.totalLoadedPhotos() }} loaded
      photos
    </p>
    } @else {
    <p>Showing {{ photoService.totalPhotos() }} amazing photos</p>
    }
  </div>
  }

  <!-- Loading message while fetching -->
  @if (photoService.isLoading() && photoService.totalPhotos() === 0) {
  <div class="loading-message">
    <p>ðŸ”„ Loading amazing photos...</p>
  </div>
  }

  <!-- Show photos when loaded -->
  @if (photoService.totalPhotos() > 0) {
    <div class="photos-grid">
      @for (photo of photoService.photos(); track photo.id) {
      <photo-card [photo]="photo"></photo-card>
      }
    </div>

    @if(!photoService.searchQuery()){
    <!-- Load More Section -->
    <div class="load-more-section">
      @if (photoService.isLoadingMore()) {
      <div class="loading-more">
        <p>ðŸ”„ Loading more photos...</p>
      </div>
      } @else if (photoService.hasMorePhotos()) {
      <button
        (click)="loadMorePhotos()"
        class="load-more-button"
        [disabled]="photoService.isLoading()"
      >
        ðŸ“· Load More Photos ({{ photoService.totalPhotos() }} so far)
      </button>
      } @else {
      <div class="no-more-photos">
        <p>ðŸŽ‰ That's all the photos for now! ({{ photoService.totalPhotos() }} total)</p>
      </div>
      }
    </div>
    }
  }

  <!-- Show error if something goes wrong -->
  @if (photoService.hasError()) {
  <div class="error-message">
    <p>ðŸ˜ž Oops! Couldn't load photos. Please try again.</p>
    <button (click)="resetAndLoadPhotos()" class="retry-button">Try Again</button>
  </div>
  }
</div>

<!-- ðŸ”¥ SCROLL TO TOP BUTTON -->
@if (showScrollToTop()) {
<button
  (click)="scrollToTop()"
  class="scroll-to-top-button"
  aria-label="Scroll to top"
  title="Back to top"
>
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <polyline points="18,15 12,9 6,15"></polyline>
  </svg>
</button>
}
